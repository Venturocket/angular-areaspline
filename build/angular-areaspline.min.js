/*! angular-areaspline 2014-01-21 */
angular.module("vr.directives.areaspline",["d3"]).directive("areaspline",["$timeout",function(a){return{restrict:"EA",replace:!0,scope:{data:"="},template:'<svg class="areaspline"><g d3 d3-data="histData" d3-renderer="render"><path></path></g></svg>',link:function(b,c,d){function e(){a(function(){h.select("g").attr("transform","scale("+(f?i.width()/b.width:"1")+","+(g?i.height()/b.height:"1")+")")})}b.area=d3.svg.area().interpolate("basis").x(function(a){return b.x(a[0])}).y0(function(){return b.height}).y1(function(a){return b.y(a[1])}),b.width=angular.isUndefined(d.width)?"auto":d.width,b.height=angular.isUndefined(d.height)?"auto":d.height;var f="auto"==b.width,g="auto"==b.height,h=d3.select(c[0]),i=$(c).parent();f&&(b.width=i.width()),g&&(b.height=i.height()),(f||g)&&($(window).resize(e),b.$on("resizeAreaSpline",e)),b.render=function(a,c){(f||g)&&e(),b.x=d3.scale.linear().range([0,b.width]),b.y=d3.scale.linear().range([b.height,0]),b.x.domain([0,c.length-1]),b.y.domain(d3.extent(c,function(a){return a[1]}));var i=h.select("path");d.transition?i.transition().attr("d",b.area(c)):i.attr("d",b.area(c))},b.$watch("data",function(a){a&&(b.histData=a.map(function(a,b){return[b,a]}))},!0)}}}]);